<!DOCTYPE html>
<html>
<head>
    <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.20/css/jquery.dataTables.css">
  
  <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
  
  <link rel="shortcut icon" type="image/png" href="https://cdn2.iconfinder.com/data/icons/user-interface-essentials-outline/48/ui-49-512.png"/>
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js">
  </script>
<link rel="stylesheet" href="/css/customerdata.css" >
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</head>
<style>
  body {
    margin: 0;
   
  }
  
  .header {
    background-color: #f1f1f1;
    padding: 30px;
    text-align: center;
  }
  
  #navbar {
    z-index: 150;
    overflow: hidden;
    background-color: #111;
  }
  
  #navbar a {
    float: right;
    display: block;
    color: #f2f2f2;
    text-align: center;
    padding: 14px 16px;
    text-decoration: none;
    font-size: 17px;
  }
  .testtttt {
  float: right;
  overflow: hidden;
}

.testtttt .dropbtn {
  font-size: 16px;  
  border: none;
  outline: none;
  color: white;
  padding: 14px 16px;
  background-color: inherit;
  font-family: inherit;
  margin: 0;
}

.navbar a:hover, .testtttt:hover .dropbtn {
  background-color: red;
}

.dropdown-content {
  display: none;
  position: absolute;
 background-color: #111;
  min-width: 100px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  float: none;
  color: white;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.dropdown-content a:hover {
  background-color: #ddd;
}

.testtttt:hover .dropdown-content {
  display: block;
}
  #navbar a:hover {
    background-color: #ddd;
    color: black;
  }
  
  #navbar a.active {
    
    color: white;
  }
  
  .content {
    padding: 16px;
  }
  
  .sticky {
    position: fixed;
    top: 0;
    width: 100%;
  }
  
  .sticky + .content {
    padding-top: 60px;
  }
  .main{
    padding: 46px 10px 15px;
  }
  </style>
 <div id="navbar">
  <div class="testtttt">

  <button class="dropbtn">Vishal460
    
  </button>
  <div class="dropdown-content">
    <a href="/logout">Logout</a>
   
  </div>
</div> 
  
</div>
<body bgcolor="#E6E6FA">
  
<div class="sidebar">
    <a><div id="google_translate_element"></div></a>
  <a<button class="btn"><i class="fa fa-whatsapp"></i></button></a>
  <a href="/whatsappdatafetch"><i class="fa fa-fw fa-home"></i> Home</a>
  <a href="/changepassword"><i class="fa fa-fw fa-wrench"></i> change password</a>
  <a href="/products"><i class="fa fa-fw fa-user"></i>Add a customer</a>
  <a href="/dowhatsapp"><i class="fa fa-fw fa-envelope"></i> send whatsapp message</a>
  <a href="/ordercrm"><i class="fa fa-fw fa-envelope"></i>Orders CRM</a>
  <a href="#contact"><i class="fa fa-fw fa-envelope"></i>Plans & Pricing</a>
  <a href="#contact"><i class="fa fa-fw fa-envelope"></i>FAQs</a>
  <a href="#contact"><i class="fa fa-fw fa-envelope"></i>Email Support</a>
</div>

<div  class="main">
 <center><h1> WHATSAPP </h1></center> 
 <p>total count  :<%= totalcount %></p>
 <form id="idForm" align="right" >
    FROM: <input type="date" id="from" name="from">
     TO: <input type="date" id="to" name="to">
    <input type="submit"><br>
    
  </form>
  week:<p align="left" id="week"></p> <h1 align="right" id="calshow"></h1>

  <div align="center" id="piechart"></div>
  <aside> 
 <table id="myTable" width="1000" height="100" border="1px">
  
    <caption><b>USERS LIST</b></caption>
    <thead>
    <tr>
      <td><b>
          <div class="dropdown">
            <button class="dropbtn">action</button>
            <div class="dropdown-content">
              <a> <input type="checkbox" name="selectedfordelete" id="select_all" />Select all</a>
              <a> <button type="button" class="button" name="deleteselected">delete</button></a>
              <a> <button type="button" name="deleteselected">delete</button></a>
            </div>
          </div>
        </b></td>
        <td> <b>service user id </b> </td>
        <td><b>whatsapp number</b></td>
        <td><b>message count</b></td>
    </tr>
    </thead>
    <tfoot>
        <tr>
          <td><b>
              <div class="dropdown">
                <button class="dropbtn">action</button>
                <div class="dropdown-content">
                  <a> <input type="checkbox" name="selectedfordelete" id="select_all" />Select all</a>
                  <a> <button type="button" class="button" name="deleteselected">delete</button></a>
                  <a> <button type="button" name="deleteselected">delete</button></a>
                </div>
              </div>
            </b></td>
          <td> <b>service user id </b> </td>
          <td><b>whatsapp number</b></td>
          <td><b>message count</b></td>
          
        </tr>
    </tfoot>
    <tbody>
    <% for (var i =0; i < data.length;  i++ ) { %>
    <tr>
      <td><b><input type="checkbox" name="checkdelete" value="<%= data[i].whatsappno %>"><br></b></td>
      <td> <b><%= data[i].client_id %></b> </td>
      <td><b><%=data[i].whatsappno %></b></td>
      <td><b><%= data[i].message_count %></b></td>
    </tr>
    <% } %>
  </tbody>
  </table>
</div>    
</body>
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script>
$("#idForm").submit(function(e) {

e.preventDefault(); // avoid to execute the actual submit of the form.

var form = $(this);
var url = form.attr('action');
                   $.ajax({
                   type: 'POST',
                   url: '/calendcheck',
                   data: form.serialize(),
                   success: function (data) {
                     console.log(data)
                     document.getElementById('calshow').innerHTML = data
                    // $("calshow").html(data);
        }
      });
})



// Load google charts
google.charts.load('current', {'packages':['corechart']});
google.charts.setOnLoadCallback(drawChart);

// Draw the chart and set the chart values
function drawChart() {

  $.ajax({
                   type: 'GET',
                   url: '/drawchart',
                   success: function (dataa) {
                     //console.log(dataa)
                     document.getElementById('week').innerHTML = dataa[0]
                    // $("calshow").html(data);
                   // var datas =Number(dataa);
        
        
    
      
  var data = google.visualization.arrayToDataTable([
  ['Task', 'Hours per Day'],
  ['TODAY', dataa[2]],
  ['THIS WEEK',dataa[0]],
  ['THIS MONTH',dataa[1]],
  ['QUARTER',0],
  ['YEAR', 167]
]);

  // Optional; add a title and set the width and height of the chart
  var options = {'title':'My Average Day', 'width':600, 'height':400};

  // Display the chart inside the <div> element with id="piechart"
  var chart = new google.visualization.PieChart(document.getElementById('piechart'));
  chart.draw(data, options);
 }
});
}

$(document).ready( function () {
    $('#myTable').DataTable();
} );
</script>
<script>
  window.onscroll = function() {myFunction()};
  
  var navbar = document.getElementById("navbar");
  var sticky = navbar.offsetTop;
  
  function myFunction() {
    if (window.pageYOffset >= sticky) {
      navbar.classList.add("sticky")
    } else {
      navbar.classList.remove("sticky");
    }
  }
  function googleTranslateElementInit() {
   new google.translate.TranslateElement({pageLanguage: 'en'}, 'google_translate_element');
   }
   $(document).ready(function ()
    {

        $("button[name='deleteselected']").click(function ()
         {
          var r = confirm("Are you sure do you really want to delete these customers ?");
          if(r==true)
          {

            var favorite = [];
             $.each($("input[name='checkdelete']:checked"), function ()
              {
                 favorite.push($(this).val());

        //Prevent the default submit
              });
                   $('#loading').css('display', 'block');
                   $.ajax({
                   type: 'POST',
                   url: '/deletecustomercheckbox',
                   data: { data: favorite },
                   success: function (data) {
                   console.log("data is :" + data)
                   if (data === "noerror")
                    {
                       $('#loading').css('display', 'none')
                       location.href = "/customerdatafetch?msg=deleted successfully"
                    }

          // location.reload(true);
          // res.redirect('/customerdatafetch?msg=deleted successfully');        
        }
      });
    }
    else{
     var txt = "You pressed Cancel!";
    }
    });
    
  });


  $('#select_all').click(function () {
    if (this.checked) {
      $("input[name='checkdelete']").each(function () {
        this.checked = true;
      });
    } else {
      $("input[name='checkdelete']").each(function () {
        this.checked = false;
      });
    }


  });
  </script>
</html>














